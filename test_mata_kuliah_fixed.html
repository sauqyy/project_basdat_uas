<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Mata Kuliah - Fixed</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Test Mata Kuliah - Fixed Version</h2>
        <p>Ini adalah test untuk memastikan error redeclaration sudah diperbaiki.</p>
        
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Kode MK</th>
                        <th>Nama MK</th>
                        <th>SKS</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>MK002</td>
                        <td>Pemrograman Web</td>
                        <td>3</td>
                        <td>
                            <button type="button" class="btn btn-sm btn-warning me-1 edit-mk-btn" data-id="1" title="Edit Mata Kuliah">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-danger delete-mk-btn" data-id="1" data-name="Pemrograman Web" title="Hapus Mata Kuliah">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>MK003</td>
                        <td>Basis Data</td>
                        <td>3</td>
                        <td>
                            <button type="button" class="btn btn-sm btn-warning me-1 edit-mk-btn" data-id="2" title="Edit Mata Kuliah">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-danger delete-mk-btn" data-id="2" data-name="Basis Data" title="Hapus Mata Kuliah">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="mt-4">
            <h4>Console Output:</h4>
            <div id="console-output" class="bg-dark text-light p-3" style="height: 300px; overflow-y: auto; font-family: monospace;">
                <div>Console output will appear here...</div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Test Functions -->
    <script>
        // Override console.log to show in page
        const originalLog = console.log;
        const consoleOutput = document.getElementById('console-output');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const div = document.createElement('div');
            div.textContent = new Date().toLocaleTimeString() + ': ' + args.join(' ');
            div.style.marginBottom = '5px';
            div.style.fontSize = '12px';
            consoleOutput.appendChild(div);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        };
        
        // Global variables - NO DUPLICATION
        let deleteMataKuliahId = null;
        
        // Edit Mata Kuliah Function - NO DUPLICATION
        function editMataKuliah(id) {
            console.log('editMataKuliah called with id:', id);
            alert('Edit Mata Kuliah function called with ID: ' + id);
        }
        
        // Delete Mata Kuliah Function - NO DUPLICATION
        function deleteMataKuliah(id, name) {
            console.log('deleteMataKuliah called with id:', id, 'name:', name);
            alert('Delete Mata Kuliah function called with ID: ' + id + ', Name: ' + name);
        }
        
        // Confirm Delete Mata Kuliah Function
        function confirmDeleteMataKuliah() {
            if (deleteMataKuliahId) {
                console.log('Confirm delete called for ID:', deleteMataKuliahId);
                alert('Confirm delete for ID: ' + deleteMataKuliahId);
            }
        }
        
        // Event Listeners - NO DUPLICATION
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, setting up mata kuliah event listeners...');
            
            // Edit button event listeners
            const editButtons = document.querySelectorAll('.edit-mk-btn');
            console.log('Found edit buttons:', editButtons.length);
            
            editButtons.forEach((btn, index) => {
                console.log(`Setting up edit button ${index}:`, btn);
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    console.log('Edit button clicked, id:', id);
                    editMataKuliah(id);
                });
            });
            
            // Delete button event listeners
            const deleteButtons = document.querySelectorAll('.delete-mk-btn');
            console.log('Found delete buttons:', deleteButtons.length);
            
            deleteButtons.forEach((btn, index) => {
                console.log(`Setting up delete button ${index}:`, btn);
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    const name = this.getAttribute('data-name');
                    console.log('Delete button clicked, id:', id, 'name:', name);
                    deleteMataKuliah(id, name);
                });
            });
            
            // Test if Bootstrap is available
            console.log('Bootstrap available:', typeof bootstrap !== 'undefined');
            console.log('Bootstrap Modal available:', typeof bootstrap?.Modal !== 'undefined');
            
            console.log('All event listeners set up successfully!');
        });
    </script>
</body>
</html>

